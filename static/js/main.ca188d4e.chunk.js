(this["webpackJsonpsimple-discovery"]=this["webpackJsonpsimple-discovery"]||[]).push([[0],{51:function(e,t,n){e.exports=n.p+"static/media/placeholder.f7c55a13.png"},61:function(e,t,n){e.exports=n(90)},66:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(7),c=n.n(i),o=(n(66),n(10)),u=n(11),l=n.n(u),s=function(e,t){for(var n=[],a=0;a<e.length;a+=t)n.push(e.slice(a,a+t));return n},m=n(51),d=n.n(m),f=function(){var e=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.length<=e;)t+=n.charAt(Math.floor(Math.random()*n.length));return t}(16),t="https://accounts.spotify.com/authorize?response_type=token&client_id="+encodeURIComponent("a4e259d0257745afb6d9bc995d65808d")+"&scope="+encodeURIComponent("user-top-read user-read-private user-read-email playlist-modify-public playlist-read-private")+"&redirect_uri="+encodeURIComponent("https://alexndesousa.github.io/simple-discovery/")+"&state="+encodeURIComponent(e);window.location=t},h=function(e){var t=function(){for(var e={},t=window.location.hash.substring(1).split("&"),n=0;n<t.length;n++){var a=t[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}();e({Authorization:" "+t.token_type+" "+t.access_token})},p="https://api.spotify.com/v1";l.a.interceptors.response.use((function(e){return e}),(function(e){console.log("error.response",e.response);var t=e.config,n=e.response.status,a=t;return 429===n||500===n?function(e,t){return console.log("originalRequest",t),new Promise((function(n,a){setTimeout((function(){return n(l()({method:t.method,url:t.url,data:t.data,headers:t.headers}))}),e)}))}(1e3*e.response.headers["retry-after"],a):401===n?(f(),Promise.reject(e)):Promise.reject(e)}));var g=function(e){return l.a.get(p+"/me",{headers:e}).then((function(e){return e.data.id}))},b=function(e,t){var n=p+"/artists/"+e+"/related-artists";return l.a.get(n,{headers:t}).then((function(e){return e.data.artists.map((function(e){return e.id}))}))},v=function(e,t){var n=[],a=e.map((function(e){return b(e,t).then((function(e){return n=n.concat(e),e}))}));return Promise.all(a).then((function(){return n.filter((function(e,t,n){return n.indexOf(e)===t}))}))},y=function(e,t){var n=[],a=e.map((function(e){return l.a.get("https://api.spotify.com/v1/artists/"+e+"/top-tracks?country=GB",{headers:t}).then((function(e){var t=e.data.tracks.map((function(e){return e.uri}));n=n.concat(t)}))}));return Promise.all(a).then((function(){return n}))},E=function(e,t){var n=p+"/users/"+t+"/playlists";e["Content-Type"]="application/json";return l.a.post(n,{name:"Simple discovery",description:"Created by simple-discovery"},{headers:e}).then((function(e){return e.data.id}))},j=function(e,t,n){console.log("final allSongs",e);var a=s(e,100).map((function(e){return l.a.post(p+"/playlists/"+t+"/tracks",{uris:e},{headers:n}).then((function(e){return e}))}));return Promise.all(a)},O=function(e,t){var n=[],a=[],r=e.map((function(e){return l.a.get(p+"/artists/"+e+"/albums",{headers:t}).then((function(e){var t=e.data.items.map((function(e){return e.id}));return n.length+t.length<=20?n=n.concat(t):(a.push(n),n=[].concat(t)),e}))}));return Promise.all(r).then((function(e){return a.push(n),a}))},S=function(e,t){var n=[],a=e.map((function(e){return l.a.get(p+"/albums/?ids="+e.toString(),{headers:t}).then((function(e){var t=e.data.albums.map((function(e){return e.tracks.items.map((function(e){return e.id}))}));return n=n.concat(t.flat()),e}))}));return Promise.all(a).then((function(e){return s(n,100)}))},C=function(e,t){var n=[],a=e.map((function(e){return l.a.get(p+"/audio-features/?ids="+e.toString(),{headers:t}).then((function(e){return n=n.concat(e.data.audio_features),e}))}));return Promise.all(a).then((function(e){return n}))},k=function(e,t){return l.a.get(p+"/audio-features/"+encodeURIComponent(e),{headers:t}).then((function(e){return e.data}))},P=function(e,t){return l.a.get(p+"/playlists/"+e,{headers:t}).then((function(e){return e.data.tracks.total}))},w=function(e,t,n){for(var a=[],r=[],i=0;i<t;i+=100)r.push(l.a.get(p+"/playlists/"+e+"/tracks?offset="+i,{headers:n}).then((function(e){var t=e.data.items.map((function(e){return e.track.artists[0].id})).filter((function(e,t,n){return n.indexOf(e)===t}));return a=a.concat(t),e})));return Promise.all(r).then((function(e){return a}))},I=function(e,t){return l.a.get(p+"/me/playlists?limit=50",{headers:e}).then((function(e){console.log("response from playlists",e.data);var n=e.data.items.map((function(e){return{name:e.name,id:e.id,image:e.images[0].url}}));t(n),console.log("formatted data",n)}))},x=function(e,t,n,a){var r=p+"/search?q="+encodeURIComponent(e)+"&type="+encodeURIComponent("artist");return l.a.get(r,{headers:t}).then((function(e){var t=e.data.artists.items.map((function(e){return{name:e.name,id:e.id,image:void 0!==e.images[0]?e.images[0].url:d.a}}));n(t),a(!1)})).catch((function(e){console.log(e)}))},R=function(e,t,n,a){var r=p+"/search?q="+encodeURIComponent(e)+"&type="+encodeURIComponent("track");return l.a.get(r,{headers:t}).then((function(e){console.log("SONG SEARCH RESPONSE",e);var t=e.data.tracks.items.map((function(e){return{name:e.name,id:e.id,artist:e.artists[0].name,artist_id:e.artists[0].id,image:e.album.images[0].url}}));n(t),a(!1)})).catch((function(e){console.log(e)}))},U=function(e,t,n){var a=[];P(e,t).then((function(n){return w(e,n,t)})).then((function(e){return v(e,t)})).then((function(e){return y(e,t)})).then((function(e){return a=e,g(t)})).then((function(e){return E(t,e)})).then((function(e){return j(a,e,t)})).then((function(){return n(!0)}))},V=function(e,t,n){var a=[];b(e,t).then((function(e){return y(e,t)})).then((function(e){return a=e,g(t)})).then((function(e){return E(t,e)})).then((function(e){return j(a,e,t)})).then((function(){return n(!0)}))},M=function(e,t,n,a){var r=[],i=[];b(e,n).then((function(e){return O(e,n)})).then((function(e){return S(e,n)})).then((function(e){return C(e,n)})).then((function(e){return r=e,k(t,n)})).then((function(e){i=r.filter((function(t){return null!==t&&(t.tempo>.9*e.tempo&&t.tempo<1.1*e.tempo&&t.energy>.8*e.energy&&t.energy<1.2*e.energy&&t.valence>.8*e.valence&&t.valence<1.2*e.valence)})).map((function(e){return e.uri}))})).then((function(){return g(n)})).then((function(e){return E(n,e)})).then((function(e){return j(i,e,n)})).then((function(){return a(!0)}))},_=n(17),L=n(122),N=n(128),z=n(129),A=n(131),T=n(130),q=n(127),B=n(132),F=n(136),G=n(126),H=Object(L.a)((function(e){return{paper:{position:"absolute",maxWidth:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),borderRadius:"3%"}}})),J=function(e){var t=e.open,n=e.handleClose,a=e.isPlaylistCreated,i=e.isCloseAllowed,c=H();return r.a.createElement("div",null,r.a.createElement(F.a,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:t,onClose:n,disableBackdropClick:i,disableEscapeKeyDown:i,style:{display:"flex",alignItems:"center",justifyContent:"center"}},a?r.a.createElement("div",{className:c.paper,align:"center"},r.a.createElement("h2",null,"Playlist created"),r.a.createElement("p",null,"(Click off this box to close it)")):r.a.createElement("div",{className:c.paper},r.a.createElement("h2",{id:"simple-modal-title"},"Generating playlist"),r.a.createElement("div",{align:"center"},r.a.createElement(G.a,null)))))},K=Object(L.a)({card:{maxWidth:345},media:{height:140}}),W=function(e){var t=e.id,n=e.image,i=e.name,c=e.functionToExecute,u=e.isPlaylistCreated,l=e.setPlaylistCreated,s=K(),m=Object(a.useState)(!1),d=Object(o.a)(m,2),f=d[0],h=d[1],p=Object(a.useState)(!0),g=Object(o.a)(p,2),b=g[0],v=g[1];Object(a.useEffect)((function(){u&&v(!1)}),[u]);return r.a.createElement(q.a,{item:!0,align:"center"},r.a.createElement(J,{open:f,handleClose:function(){h(!1),u&&l(!1)},isPlaylistCreated:u,isCloseAllowed:b}),r.a.createElement(N.a,{className:s.card,onClick:function(){c.apply(void 0,Object(_.a)(t)),h(!0)}},r.a.createElement(z.a,null,r.a.createElement(T.a,{className:s.media,image:n,title:i}),r.a.createElement(A.a,null,r.a.createElement(B.a,{variant:"h5",component:"h2"},i)))))},D=n(135),Q=n(133),X=function(e){var t=e.searchLabel,n=e.newSearch,i=e.handleSearch,c=e.header,u=e.setValues,l=e.type,s=null;s="song"===l?R:x;var m=Object(a.useState)(!1),d=Object(o.a)(m,2),f=d[0],h=d[1],p=function(){h(!0)};return Object(a.useEffect)((function(){null!==c&&f&&s(n,c,u,h)}),[n,c,u,f]),r.a.createElement(q.a,{container:!0,direction:"column",justify:"center",alignItems:"center",spacing:2,style:{margin:"0",width:"100%"}},r.a.createElement(D.a,{id:"filled-basic",label:t,margin:"normal",variant:"filled",value:n,onChange:i,onKeyPress:function(e){"Enter"===e.key&&p()}}),r.a.createElement(Q.a,{variant:"contained",onClick:function(){return p()}},"search"))},Y=function(e){var t=e.searchLabel,n=e.newSearch,i=e.handleSearch,c=e.header,o=e.setValues,u=I;return Object(a.useEffect)((function(){null!==c&&u(c,o)}),[n,c,o]),r.a.createElement(q.a,{container:!0,direction:"column",justify:"center",alignItems:"center",spacing:2,style:{margin:"0",width:"100%"}},r.a.createElement(D.a,{id:"filled-basic",label:t,margin:"normal",variant:"filled",value:n,onChange:i}))},Z=n(134),$=n(53),ee=n.n($),te=function(e){var t=e.musicItems;return r.a.createElement(q.a,{container:!0,direction:"column",justify:"center",alignItems:"stretch",spacing:2,style:{minHeight:"80vh",margin:"0",width:"100%"}},t)},ne=Object(L.a)({back_button:{left:"10%"}}),ae=function(e){var t=e.isPageVisible,n=e.togglePage,a=e.toggleMainMenu,i=e.searchLabel,c=e.newSearch,o=e.handleSearch,u=e.header,l=e.setValues,s=e.type,m=e.musicItems,d=ne();return r.a.createElement(r.a.Fragment,null,t?r.a.createElement("div",null,r.a.createElement(Z.a,{className:d.back_button,onClick:function(){n(),a()}},r.a.createElement(ee.a,{fontSize:"large"})),"playlist"===s?r.a.createElement(Y,{searchLabel:i,newSearch:c,handleSearch:o,header:u,setValues:l}):r.a.createElement(X,{searchLabel:i,newSearch:c,handleSearch:o,header:u,setValues:l,type:s}),r.a.createElement(te,{musicItems:m})):null)},re=function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)(""),u=Object(o.a)(c,2),l=u[0],s=u[1],m=Object(a.useState)(""),d=Object(o.a)(m,2),p=d[0],g=d[1],b=Object(a.useState)([]),v=Object(o.a)(b,2),y=v[0],E=v[1],j=Object(a.useState)([]),O=Object(o.a)(j,2),S=O[0],C=O[1],k=Object(a.useState)([]),P=Object(o.a)(k,2),w=P[0],I=P[1],x=Object(a.useState)(!1),R=Object(o.a)(x,2),_=R[0],L=R[1],N=Object(a.useState)(null),z=Object(o.a)(N,2),A=z[0],T=z[1],B=Object(a.useState)(""),F=Object(o.a)(B,2),G=(F[0],F[1],Object(a.useState)(!0)),H=Object(o.a)(G,2),J=H[0],K=(H[1],Object(a.useState)(!0)),D=Object(o.a)(K,2),X=D[0],Y=D[1],Z=Object(a.useState)(!1),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ne=Object(a.useState)(!1),re=Object(o.a)(ne,2),ie=re[0],ce=re[1],oe=Object(a.useState)(!1),ue=Object(o.a)(oe,2),le=ue[0],se=ue[1],me=function(){Y(!X)},de=function(){se(!le)},fe=function(){te(!ee)},he=function(){ce(!ie)};Object(a.useEffect)((function(){console.log("hello from the useEffect thingy mabob"),h(T)}),[]);var pe=function(e){U(e,A,L)},ge=function(e){V(e,A,L)},be=function(e,t){M(e,t,A,L)},ve=w.filter((function(e){return e.name.toUpperCase().includes(n.toUpperCase())})).map((function(e){return r.a.createElement(W,{key:e.id,id:[e.id],image:e.image,name:e.name,functionToExecute:pe,isPlaylistCreated:_,setPlaylistCreated:L})})),ye=y.map((function(e){return r.a.createElement(W,{key:e.id,id:[e.id],image:e.image,name:e.name,functionToExecute:ge,isPlaylistCreated:_,setPlaylistCreated:L})})),Ee=S.map((function(e){return r.a.createElement(W,{key:e.id,id:[e.artist_id,e.id],image:e.image,name:"".concat(e.name," - ").concat(e.artist),functionToExecute:be,isPlaylistCreated:_,setPlaylistCreated:L})})),je=r.a.createElement(r.a.Fragment,null,X?r.a.createElement(q.a,{container:!0,direction:"column",justify:"center",alignItems:"center",spacing:2,style:{minHeight:"80vh",margin:"0",width:"100%"}},r.a.createElement("h2",null,"Select an option from the list below"),r.a.createElement(q.a,{item:!0},r.a.createElement(Q.a,{variant:"contained",size:"large",onClick:function(){de(),me()}},"import playlist")),r.a.createElement(q.a,{item:!0},r.a.createElement(Q.a,{variant:"contained",size:"large",onClick:function(){fe(),me()}},"search artist")),r.a.createElement(q.a,{item:!0},r.a.createElement(Q.a,{variant:"contained",size:"large",onClick:function(){he(),me()}},"search song"))):null),Oe=r.a.createElement(r.a.Fragment,null,r.a.createElement(ae,{isPageVisible:le,togglePage:de,toggleMainMenu:me,searchLabel:"Playlist name",newSearch:n,handleSearch:function(e){i(e.target.value)},header:A,setValues:I,type:"playlist",musicItems:ve})),Se=r.a.createElement("div",null,r.a.createElement(ae,{isPageVisible:ee,togglePage:fe,toggleMainMenu:me,searchLabel:"Artist name",newSearch:l,handleSearch:function(e){s(e.target.value)},header:A,setValues:E,type:"artist",musicItems:ye})),Ce=r.a.createElement("div",null,r.a.createElement(ae,{isPageVisible:ie,togglePage:he,toggleMainMenu:me,searchLabel:"Song name",newSearch:p,handleSearch:function(e){g(e.target.value)},header:A,setValues:C,type:"song",musicItems:Ee}));return r.a.createElement("div",null,J?r.a.createElement("button",{onClick:function(){return f()}},"authenticate"):null,je,Oe,Se,Ce)};c.a.render(r.a.createElement(re,null),document.getElementById("root"))}},[[61,1,2]]]);
//# sourceMappingURL=main.ca188d4e.chunk.js.map