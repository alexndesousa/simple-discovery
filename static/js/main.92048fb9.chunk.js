(this["webpackJsonpsimple-discovery"]=this["webpackJsonpsimple-discovery"]||[]).push([[0],{55:function(e,t,n){e.exports=n.p+"static/media/placeholder.f7c55a13.png"},65:function(e,t,n){e.exports=n(94)},70:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(7),c=n.n(i),o=(n(70),n(10)),l=n(11),u=n.n(l),s=function(e,t){for(var n=[],a=0;a<e.length;a+=t)n.push(e.slice(a,a+t));return n},m=n(55),d=n.n(m),f=function(){var e=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.length<=e;)t+=n.charAt(Math.floor(Math.random()*n.length));return t}(16),t="https://accounts.spotify.com/authorize?response_type=token&client_id="+encodeURIComponent("a4e259d0257745afb6d9bc995d65808d")+"&scope="+encodeURIComponent("user-top-read user-read-private user-read-email playlist-modify-public playlist-read-private")+"&redirect_uri="+encodeURIComponent("https://alexndesousa.github.io/simple-discovery/")+"&state="+encodeURIComponent(e);window.location=t},h=function(e){var t=function(){for(var e={},t=window.location.hash.substring(1).split("&"),n=0;n<t.length;n++){var a=t[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}();e({Authorization:" "+t.token_type+" "+t.access_token})},p="https://api.spotify.com/v1";u.a.interceptors.response.use((function(e){return e}),(function(e){console.log("error.response",e.response);var t=e.config,n=e.response.status,a=t;return 429===n||500===n?function(e,t){return console.log("originalRequest",t),new Promise((function(n,a){setTimeout((function(){return n(u()({method:t.method,url:t.url,data:t.data,headers:t.headers}))}),e)}))}(1e3*e.response.headers["retry-after"],a):401===n?(f(),Promise.reject(e)):Promise.reject(e)}));var g=function(e){return u.a.get(p+"/me",{headers:e}).then((function(e){return e.data.id}))},b=function(e,t){var n=p+"/artists/"+e+"/related-artists";return u.a.get(n,{headers:t}).then((function(e){return e.data.artists.map((function(e){return e.id}))}))},v=function(e,t){var n=[],a=e.map((function(e){return b(e,t).then((function(e){return n=n.concat(e),e}))}));return Promise.all(a).then((function(){return n.filter((function(e,t,n){return n.indexOf(e)===t}))}))},y=function(e,t){var n=[],a=e.map((function(e){return u.a.get("https://api.spotify.com/v1/artists/"+e+"/top-tracks?country=GB",{headers:t}).then((function(e){var t=e.data.tracks.map((function(e){return e.uri}));n=n.concat(t)}))}));return Promise.all(a).then((function(){return n}))},E=function(e,t){var n=p+"/users/"+t+"/playlists";e["Content-Type"]="application/json";return u.a.post(n,{name:"Simple discovery",description:"Created by simple-discovery"},{headers:e}).then((function(e){return e.data.id}))},j=function(e,t,n){console.log("final allSongs",e);var a=s(e,100).map((function(e){return u.a.post(p+"/playlists/"+t+"/tracks",{uris:e},{headers:n}).then((function(e){return e}))}));return Promise.all(a)},C=function(e,t){var n=[],a=[],r=e.map((function(e){return u.a.get(p+"/artists/"+e+"/albums",{headers:t}).then((function(e){var t=e.data.items.map((function(e){return e.id}));return n.length+t.length<=20?n=n.concat(t):(a.push(n),n=[].concat(t)),e}))}));return Promise.all(r).then((function(e){return a.push(n),a}))},S=function(e,t){var n=[],a=e.map((function(e){return u.a.get(p+"/albums/?ids="+e.toString(),{headers:t}).then((function(e){var t=e.data.albums.map((function(e){return e.tracks.items.map((function(e){return e.id}))}));return n=n.concat(t.flat()),e}))}));return Promise.all(a).then((function(e){return s(n,100)}))},O=function(e,t){var n=[],a=e.map((function(e){return u.a.get(p+"/audio-features/?ids="+e.toString(),{headers:t}).then((function(e){return n=n.concat(e.data.audio_features),e}))}));return Promise.all(a).then((function(e){return n}))},k=function(e,t){return u.a.get(p+"/audio-features/"+encodeURIComponent(e),{headers:t}).then((function(e){return e.data}))},P=function(e,t){return u.a.get(p+"/playlists/"+e,{headers:t}).then((function(e){return e.data.tracks.total}))},w=function(e,t,n){for(var a=[],r=[],i=0;i<t;i+=100)r.push(u.a.get(p+"/playlists/"+e+"/tracks?offset="+i,{headers:n}).then((function(e){var t=e.data.items.map((function(e){return e.track.artists[0].id})).filter((function(e,t,n){return n.indexOf(e)===t}));return a=a.concat(t),e})));return Promise.all(r).then((function(e){return a}))},I=function(e,t){return u.a.get(p+"/me/playlists?limit=50",{headers:e}).then((function(e){console.log("response from playlists",e.data);var n=e.data.items.map((function(e){return{name:e.name,id:e.id,image:e.images[0].url}}));t(n),console.log("formatted data",n)}))},x=function(e,t,n,a){var r=p+"/search?q="+encodeURIComponent(e)+"&type="+encodeURIComponent("artist");return u.a.get(r,{headers:t}).then((function(e){var t=e.data.artists.items.map((function(e){return{name:e.name,id:e.id,image:void 0!==e.images[0]?e.images[0].url:d.a}}));n(t),a(!1)})).catch((function(e){console.log(e)}))},R=function(e,t,n,a){var r=p+"/search?q="+encodeURIComponent(e)+"&type="+encodeURIComponent("track");return u.a.get(r,{headers:t}).then((function(e){console.log("SONG SEARCH RESPONSE",e);var t=e.data.tracks.items.map((function(e){return{name:e.name,id:e.id,artist:e.artists[0].name,artist_id:e.artists[0].id,image:e.album.images[0].url}}));n(t),a(!1)})).catch((function(e){console.log(e)}))},U=function(e,t,n){var a=[];P(e,t).then((function(n){return w(e,n,t)})).then((function(e){return v(e,t)})).then((function(e){return y(e,t)})).then((function(e){return a=e,g(t)})).then((function(e){return E(t,e)})).then((function(e){return j(a,e,t)})).then((function(){return n(!0)}))},V=function(e,t,n){var a=[];b(e,t).then((function(e){return y(e,t)})).then((function(e){return a=e,g(t)})).then((function(e){return E(t,e)})).then((function(e){return j(a,e,t)})).then((function(){return n(!0)}))},M=function(e,t,n,a){var r=[],i=[];b(e,n).then((function(e){return C(e,n)})).then((function(e){return S(e,n)})).then((function(e){return O(e,n)})).then((function(e){return r=e,k(t,n)})).then((function(e){i=r.filter((function(t){return null!==t&&(t.tempo>.9*e.tempo&&t.tempo<1.1*e.tempo&&t.energy>.8*e.energy&&t.energy<1.2*e.energy&&t.valence>.8*e.valence&&t.valence<1.2*e.valence)})).map((function(e){return e.uri}))})).then((function(){return g(n)})).then((function(e){return E(n,e)})).then((function(e){return j(i,e,n)})).then((function(){return a(!0)}))},L=n(17),_=n(125),N=n(131),z=n(132),A=n(134),F=n(133),T=n(130),B=n(135),q=n(140),D=n(129),G=Object(_.a)((function(e){return{paper:{position:"absolute",maxWidth:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),borderRadius:"3%"}}})),H=function(e){var t=e.open,n=e.handleClose,a=e.isPlaylistCreated,i=e.isCloseAllowed,c=G();return r.a.createElement("div",null,r.a.createElement(q.a,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:t,onClose:n,disableBackdropClick:i,disableEscapeKeyDown:i,style:{display:"flex",alignItems:"center",justifyContent:"center"}},a?r.a.createElement("div",{className:c.paper,align:"center"},r.a.createElement("h2",null,"Playlist created"),r.a.createElement("p",null,"(Click off this box to close it)")):r.a.createElement("div",{className:c.paper},r.a.createElement("h2",{id:"simple-modal-title"},"Generating playlist"),r.a.createElement("div",{align:"center"},r.a.createElement(D.a,null)))))},K=Object(_.a)({card:{maxWidth:345},media:{height:140}}),W=function(e){var t=e.id,n=e.image,i=e.name,c=e.functionToExecute,l=e.isPlaylistCreated,u=e.setPlaylistCreated,s=K(),m=Object(a.useState)(!1),d=Object(o.a)(m,2),f=d[0],h=d[1],p=Object(a.useState)(!0),g=Object(o.a)(p,2),b=g[0],v=g[1];Object(a.useEffect)((function(){l&&v(!1)}),[l]);return r.a.createElement(T.a,{item:!0,align:"center"},r.a.createElement(H,{open:f,handleClose:function(){h(!1),l&&u(!1)},isPlaylistCreated:l,isCloseAllowed:b}),r.a.createElement(N.a,{className:s.card,onClick:function(){c.apply(void 0,Object(L.a)(t)),h(!0)}},r.a.createElement(z.a,null,r.a.createElement(F.a,{className:s.media,image:n,title:i}),r.a.createElement(A.a,null,r.a.createElement(B.a,{variant:"h5",component:"h2"},i)))))},J=n(139),Q=n(136),X=function(e){var t=e.searchLabel,n=e.newSearch,i=e.handleSearch,c=e.header,l=e.setValues,u=e.type,s=null;s="song"===u?R:x;var m=Object(a.useState)(!1),d=Object(o.a)(m,2),f=d[0],h=d[1],p=function(){h(!0)};return Object(a.useEffect)((function(){null!==c&&f&&s(n,c,l,h)}),[n,c,l,f]),r.a.createElement(T.a,{container:!0,direction:"column",justify:"center",alignItems:"center",spacing:2,style:{margin:"0",width:"100%"}},r.a.createElement(J.a,{id:"filled-basic",label:t,margin:"normal",variant:"filled",value:n,onChange:i,onKeyPress:function(e){"Enter"===e.key&&p()}}),r.a.createElement(Q.a,{variant:"contained",onClick:function(){return p()}},"search"))},Y=function(e){var t=e.searchLabel,n=e.newSearch,i=e.handleSearch,c=e.header,o=e.setValues,l=I;return Object(a.useEffect)((function(){null!==c&&l(c,o)}),[n,c,o]),r.a.createElement(T.a,{container:!0,direction:"column",justify:"center",alignItems:"center",spacing:2,style:{margin:"0",width:"100%"}},r.a.createElement(J.a,{id:"filled-basic",label:t,margin:"normal",variant:"filled",value:n,onChange:i}))},Z=n(137),$=n(57),ee=n.n($),te=function(e){var t=e.musicItems;return r.a.createElement(T.a,{container:!0,direction:"column",justify:"center",alignItems:"stretch",spacing:2,style:{minHeight:"80vh",margin:"0",width:"100%"}},t)},ne=Object(_.a)({back_button:{left:"10%"}}),ae=function(e){var t=e.isPageVisible,n=e.togglePage,a=e.toggleMainMenu,i=e.searchLabel,c=e.newSearch,o=e.handleSearch,l=e.header,u=e.setValues,s=e.type,m=e.musicItems,d=ne();return r.a.createElement(r.a.Fragment,null,t?r.a.createElement("div",null,r.a.createElement(Z.a,{className:d.back_button,onClick:function(){n(),a()}},r.a.createElement(ee.a,{fontSize:"large"})),"playlist"===s?r.a.createElement(Y,{searchLabel:i,newSearch:c,handleSearch:o,header:l,setValues:u}):r.a.createElement(X,{searchLabel:i,newSearch:c,handleSearch:o,header:l,setValues:u,type:s}),r.a.createElement(te,{musicItems:m})):null)},re=n(58),ie=n(138),ce=Object(re.a)({palette:{primary:{main:"#1FD662"}}}),oe=Object(_.a)((function(e){return{paper:{position:"absolute",maxWidth:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),borderRadius:"3%"}}})),le=function(e){var t=e.open,n=e.handleClose,a=e.authFunction,i=oe();return r.a.createElement("div",null,r.a.createElement(q.a,{open:t,onClose:n,disableBackdropClick:!0,disableEscapeKeyDown:!0,style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("div",{className:i.paper,align:"center"},r.a.createElement("h2",null,"Click the button below to link your Spotify account"),r.a.createElement("div",{align:"center"},r.a.createElement(ie.a,{theme:ce},r.a.createElement(Q.a,{variant:"contained",color:"primary",onClick:function(){return a()}},"Link Spotify"))))))},ue=function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)(""),l=Object(o.a)(c,2),u=l[0],s=l[1],m=Object(a.useState)(""),d=Object(o.a)(m,2),p=d[0],g=d[1],b=Object(a.useState)([]),v=Object(o.a)(b,2),y=v[0],E=v[1],j=Object(a.useState)([]),C=Object(o.a)(j,2),S=C[0],O=C[1],k=Object(a.useState)([]),P=Object(o.a)(k,2),w=P[0],I=P[1],x=Object(a.useState)(!1),R=Object(o.a)(x,2),L=R[0],_=R[1],N=Object(a.useState)(null),z=Object(o.a)(N,2),A=z[0],F=z[1],B=Object(a.useState)(!0),q=Object(o.a)(B,2),D=q[0],G=q[1],H=Object(a.useState)(!1),K=Object(o.a)(H,2),J=K[0],X=K[1],Y=Object(a.useState)(!1),Z=Object(o.a)(Y,2),$=Z[0],ee=Z[1],te=Object(a.useState)(!1),ne=Object(o.a)(te,2),re=ne[0],ie=ne[1],ce=Object(a.useState)(!0),oe=Object(o.a)(ce,2),ue=oe[0],se=oe[1],me=function(){G(!D)},de=function(){ie(!re)},fe=function(){X(!J)},he=function(){ee(!$)},pe=function(){se(!1)};Object(a.useEffect)((function(){h(F),"https://alexndesousa.github.io/simple-discovery/"!==window.location.href&&pe()}),[]);var ge=function(e){U(e,A,_)},be=function(e){V(e,A,_)},ve=function(e,t){M(e,t,A,_)},ye=w.filter((function(e){return e.name.toUpperCase().includes(n.toUpperCase())})).map((function(e){return r.a.createElement(W,{key:e.id,id:[e.id],image:e.image,name:e.name,functionToExecute:ge,isPlaylistCreated:L,setPlaylistCreated:_})})),Ee=y.map((function(e){return r.a.createElement(W,{key:e.id,id:[e.id],image:e.image,name:e.name,functionToExecute:be,isPlaylistCreated:L,setPlaylistCreated:_})})),je=S.map((function(e){return r.a.createElement(W,{key:e.id,id:[e.artist_id,e.id],image:e.image,name:"".concat(e.name," - ").concat(e.artist),functionToExecute:ve,isPlaylistCreated:L,setPlaylistCreated:_})})),Ce=r.a.createElement(r.a.Fragment,null,D?r.a.createElement(T.a,{container:!0,direction:"column",justify:"center",alignItems:"center",spacing:2,style:{minHeight:"80vh",margin:"0",width:"100%"}},r.a.createElement("h2",null,"Select an option from the list below"),r.a.createElement(T.a,{item:!0},r.a.createElement(Q.a,{variant:"contained",size:"large",onClick:function(){de(),me()}},"import playlist")),r.a.createElement(T.a,{item:!0},r.a.createElement(Q.a,{variant:"contained",size:"large",onClick:function(){fe(),me()}},"search artist")),r.a.createElement(T.a,{item:!0},r.a.createElement(Q.a,{variant:"contained",size:"large",onClick:function(){he(),me()}},"search song"))):null),Se=r.a.createElement(r.a.Fragment,null,r.a.createElement(ae,{isPageVisible:re,togglePage:de,toggleMainMenu:me,searchLabel:"Playlist name",newSearch:n,handleSearch:function(e){i(e.target.value)},header:A,setValues:I,type:"playlist",musicItems:ye})),Oe=r.a.createElement("div",null,r.a.createElement(ae,{isPageVisible:J,togglePage:fe,toggleMainMenu:me,searchLabel:"Artist name",newSearch:u,handleSearch:function(e){s(e.target.value)},header:A,setValues:E,type:"artist",musicItems:Ee})),ke=r.a.createElement("div",null,r.a.createElement(ae,{isPageVisible:$,togglePage:he,toggleMainMenu:me,searchLabel:"Song name",newSearch:p,handleSearch:function(e){g(e.target.value)},header:A,setValues:O,type:"song",musicItems:je}));return r.a.createElement("div",null,r.a.createElement(le,{open:ue,handleClose:pe,authFunction:f}),Ce,Se,Oe,ke)};c.a.render(r.a.createElement(ue,null),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.92048fb9.chunk.js.map