(this["webpackJsonpsimple-discovery"]=this["webpackJsonpsimple-discovery"]||[]).push([[0],{126:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(7),o=n.n(i),c=(n(81),n(9)),l=n(12),s=n.n(l),u=function(e,t){for(var n=[],a=0;a<e.length;a+=t)n.push(e.slice(a,a+t));return n},m=n(65),d=n.n(m),f=n(66),h=n.n(f),g="https://api.spotify.com/v1",p=function(e,t){var n=g+"/artists/"+e+"/related-artists";return s.a.get(n,{headers:t}).then((function(e){return e.data.artists.map((function(e){return e.id}))}))},b=function(e,t){return s.a.get(g+"/me",{headers:e}).then((function(e){var n={username:e.data.display_name,id:e.data.id,email:e.data.email,country:e.country};return t(n),e.data.id}))},y=function(e,t){return s.a.get(g+"/me/playlists?limit=50",{headers:e}).then((function(e){console.log("response from playlists",e.data);var n=e.data.items.map((function(e){return{name:e.name,id:e.id,image:e.images[0].url}}));t(n),console.log("formatted data",n)}))},v=function(e,t,n,a){var r=g+"/search?q="+encodeURIComponent(e)+"&type="+encodeURIComponent("artist");return s.a.get(r,{headers:t}).then((function(e){var t=e.data.artists.items.map((function(e){return{name:e.name,id:e.id,image:void 0!==e.images[0]?e.images[0].url:h.a}}));n(t),a(!1)})).catch((function(e){console.log(e)}))},E=function(e,t,n,a){var r=g+"/search?q="+encodeURIComponent(e)+"&type="+encodeURIComponent("track");return s.a.get(r,{headers:t}).then((function(e){console.log("SONG SEARCH RESPONSE",e);var t=e.data.tracks.items.map((function(e){return{name:e.name,id:e.id,artist:e.artists[0].name,artist_id:e.artists[0].id,image:e.album.images[0].url}}));n(t),a(!1)})).catch((function(e){console.log(e)}))},j=p,O=function(e,t,n){var a=[],r=new d.a({maxConcurrent:4,minTime:500}),i=e.map((function(e){return r.schedule((function(){return s.a.get("https://api.spotify.com/v1/artists/"+e+"/top-tracks?country=GB",{headers:t}).then((function(e){var t=e.data.tracks.map((function(e){return e.uri}));a=a.concat(t)}))}))}));return Promise.all(i).then((function(){return n(a),a}))},S=function(e,t,n){var a=g+"/users/"+n+"/playlists";e["Content-Type"]="application/json";return s.a.post(a,{name:"Simple discovery",description:"Created by simple-discovery"},{headers:e}).then((function(e){return t(e.data.id),e.data.id}))},k=function(e,t,n){console.log("final allSongs",e);var a=u(e,100).map((function(e){return console.log("songBundle",e),s.a.post(g+"/playlists/"+t+"/tracks",{uris:e},{headers:n}).then((function(e){return e}))}));return Promise.all(a)},C=function(e,t){console.log("artistIDs",e);var n=[],a=[],r=e.map((function(e){return s.a.get(g+"/artists/"+e+"/albums",{headers:t}).then((function(e){var t=e.data.items.map((function(e){return e.id}));return n.length+t.length<=20?n=n.concat(t):(a.push(n),n=[].concat(t)),e}))}));return Promise.all(r).then((function(e){return a.push(n),console.log("response from getting all artists albums",e),console.log("getting all artists albums",a),a}))},I=function(e,t){var n=[],a=e.map((function(e){return s.a.get(g+"/albums/?ids="+e.toString(),{headers:t}).then((function(e){var t=e.data.albums.map((function(e){return e.tracks.items.map((function(e){return e.id}))}));return n=n.concat(t.flat()),e}))}));return Promise.all(a).then((function(e){return console.log("response form getting all trakcs",e),console.log("contents of allTracks",n),console.log("chunked array ",u(n,100)),u(n,100)}))},P=function(e,t){var n=[],a=e.map((function(e){return s.a.get(g+"/audio-features/?ids="+e.toString(),{headers:t}).then((function(e){return n=n.concat(e.data.audio_features),e}))}));return Promise.all(a).then((function(e){return console.log("response from all audio features ",e),console.log("final audio features: ",n),n}))},w=function(e,t){return s.a.get(g+"/audio-features/"+encodeURIComponent(e),{headers:t}).then((function(e){return console.log("response for getting single audioFeature",e),console.log("response for getting single audioFeature",e.data),e.data}))},x=function(e,t){return s.a.get(g+"/playlists/"+e,{headers:t}).then((function(e){return console.log("number of tracks",e.data.tracks.total),e.data.tracks.total}))},U=function(e,t,n){for(var a=[],r=[],i=0;i<t;i+=100)r.push(s.a.get(g+"/playlists/"+e+"/tracks?offset="+i,{headers:n}).then((function(e){var t=e.data.items.map((function(e){return e.track.artists[0].id})).filter((function(e,t,n){return n.indexOf(e)===t}));return a=a.concat(t),e})));return Promise.all(r).then((function(e){return console.log("response from all playlist tracks getting",e),console.log("all playlist track getting ",a),a}))},R=function(e,t){var n=[],a=e.map((function(e){return p(e,t).then((function(e){return n=n.concat(e),e}))}));return Promise.all(a).then((function(){var e=n.filter((function(e,t,n){return n.indexOf(e)===t}));return console.log("response from the promises for multiple similar artists NO DUPLICATES",e),e}))},_=function(e){var t=e.header,n=e.setUserData,i=e.setUserPlaylists;return Object(a.useEffect)((function(){null!==t&&b(t,n).then((function(){y(t,i)})).catch((function(e){console.log(e)}))}),[t,i,n]),r.a.createElement("div",null,"your profile information:")},N=n(21),M=n(158),T=n(164),V=n(165),z=n(167),L=n(166),A=n(163),D=n(168),F=n(172),B=n(162),G=Object(M.a)((function(e){return{paper:{position:"absolute",maxWidth:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),H=function(e){var t=e.open,n=e.handleClose,a=e.isPlaylistCreated,i=G();return r.a.createElement("div",null,r.a.createElement(F.a,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:t,onClose:n,style:{display:"flex",alignItems:"center",justifyContent:"center"}},a?r.a.createElement("div",{className:i.paper},r.a.createElement("h2",null,"Playlist created")):r.a.createElement("div",{className:i.paper},r.a.createElement("h2",{id:"simple-modal-title"},"Generating playlist"),r.a.createElement("div",{align:"center"},r.a.createElement(B.a,null)))))},W=Object(M.a)({card:{maxWidth:345},media:{height:140}}),q=function(e){var t=e.id,n=e.image,a=e.name,i=e.functionToExecute,o=e.isPlaylistCreated,l=W(),s=r.a.useState(!1),u=Object(c.a)(s,2),m=u[0],d=u[1];return r.a.createElement(A.a,{item:!0,align:"center"},r.a.createElement(T.a,{className:l.card,onClick:function(){i.apply(void 0,Object(N.a)(t)),d(!0)}},r.a.createElement(H,{open:m,handleClose:function(){d(!1)},isPlaylistCreated:o}),r.a.createElement(V.a,null,r.a.createElement(L.a,{className:l.media,image:n,title:a}),r.a.createElement(z.a,null,r.a.createElement(D.a,{variant:"h5",component:"h2"},a)))))},J=function(e){var t=e.musicItems;return r.a.createElement(A.a,{container:!0,direction:"column",justify:"center",alignItems:"stretch",spacing:2,style:{minHeight:"80vh",margin:"0",width:"100%"}},t)},K=n(171),Q=n(169),X=function(e){var t=e.searchLabel,n=e.newSearch,i=e.handleSearch,o=e.header,l=e.setValues,s=e.type,u=null;u="song"===s?E:v;var m=Object(a.useState)(!1),d=Object(c.a)(m,2),f=d[0],h=d[1],g=function(){h(!0)};return Object(a.useEffect)((function(){null!==o&&f&&u(n,o,l,h)}),[n,o,l,f]),r.a.createElement(A.a,{container:!0,direction:"column",justify:"center",alignItems:"center",spacing:2,style:{margin:"0",width:"100%"}},r.a.createElement(K.a,{id:"filled-basic",label:t,margin:"normal",variant:"filled",value:n,onChange:i,onKeyPress:function(e){"Enter"===e.key&&g()}}),r.a.createElement(Q.a,{variant:"contained",onClick:function(){return g()}},"search"))},Y=n(170),Z=n(39),$=n.n(Z),ee=Object(M.a)({back_button:{left:"10%"}}),te=function(e){var t=e.isPageVisible,n=e.togglePage,a=e.toggleMainMenu,i=e.searchLabel,o=e.newSearch,c=e.handleSearch,l=e.header,s=e.setValues,u=e.type,m=e.musicItems,d=ee();return r.a.createElement(r.a.Fragment,null,t?r.a.createElement("div",null,r.a.createElement(Y.a,{className:d.back_button,onClick:function(){n(),a()}},r.a.createElement($.a,{fontSize:"large"})),r.a.createElement(X,{searchLabel:i,newSearch:o,handleSearch:c,header:l,setValues:s,type:u}),r.a.createElement(J,{musicItems:m})):null)},ne=function(){var e=Object(a.useState)(""),t=Object(c.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(""),l=Object(c.a)(o,2),s=l[0],u=l[1],m=Object(a.useState)([]),d=Object(c.a)(m,2),f=d[0],h=d[1],g=Object(a.useState)([]),p=Object(c.a)(g,2),y=p[0],v=p[1],E=Object(a.useState)([]),N=Object(c.a)(E,2),T=(N[0],N[1]),V=Object(a.useState)([]),z=Object(c.a)(V,2),L=z[0],D=z[1],F=Object(a.useState)(""),B=Object(c.a)(F,2),G=(B[0],B[1]),H=Object(a.useState)([]),W=Object(c.a)(H,2),K=(W[0],W[1]),X=Object(a.useState)(!1),Z=Object(c.a)(X,2),ee=Z[0],ne=Z[1],ae=Object(a.useState)(null),re=Object(c.a)(ae,2),ie=re[0],oe=re[1],ce=Object(a.useState)(""),le=Object(c.a)(ce,2),se=(le[0],le[1]),ue=Object(a.useState)(!0),me=Object(c.a)(ue,2),de=me[0],fe=me[1],he=Object(a.useState)(!0),ge=Object(c.a)(he,2),pe=ge[0],be=ge[1],ye=Object(a.useState)(!1),ve=Object(c.a)(ye,2),Ee=ve[0],je=ve[1],Oe=Object(a.useState)(!1),Se=Object(c.a)(Oe,2),ke=Se[0],Ce=Se[1],Ie=Object(a.useState)(!1),Pe=Object(c.a)(Ie,2),we=Pe[0],xe=Pe[1],Ue=function(){be(!pe)},Re=function(){xe(!we)},_e=function(){je(!Ee)},Ne=function(){Ce(!ke)},Me=function(){var e=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.length<=e;)t+=n.charAt(Math.floor(Math.random()*n.length));return t}(16),t="https://accounts.spotify.com/authorize?response_type=token&client_id="+encodeURIComponent("a4e259d0257745afb6d9bc995d65808d")+"&scope="+encodeURIComponent("user-top-read user-read-private user-read-email playlist-modify-public playlist-read-private")+"&redirect_uri="+encodeURIComponent("https://alexndesousa.github.io/simple-discovery/")+"&state="+encodeURIComponent(e);se(e),fe(!1),window.location=t},Te=function(){var e=function(){for(var e={},t=window.location.hash.substring(1).split("&"),n=0;n<t.length;n++){var a=t[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}(),t={Authorization:" "+e.token_type+" "+e.access_token};oe(t)};Object(a.useEffect)((function(){console.log("hello from the useEffect thingy mabob"),Te()}),[]);var Ve=Object(M.a)({root:{flexgrow:1},card:{maxWidth:345},media:{height:140},back_button:{left:"10%"}})(),ze=function(e){x(e,ie).then((function(t){U(e,t,ie).then((function(e){console.log("artistIDs ",e),R(e,ie).then((function(e){O(e,ie,K).then((function(e){b(ie,T).then((function(t){S(ie,G,t).then((function(t){k(e,t,ie).then((function(e){console.log("playlist created",e),ne(!0)}))}))}))}))}))}))}))},Le=function(e){j(e,ie).then((function(e){O(e,ie,K).then((function(e){b(ie,T).then((function(t){S(ie,G,t).then((function(t){k(e,t,ie).then((function(e){console.log("playlist created",e),ne(!0)}))}))}))}))}))},Ae=function(e,t){j(e,ie).then((function(e){C(e,ie).then((function(e){I(e,ie).then((function(e){P(e,ie).then((function(e){w(t,ie).then((function(t){var n=e.filter((function(e){return e.tempo>.9*t.tempo&&e.tempo<1.1*t.tempo&&e.energy>.8*t.energy&&e.energy<1.2*t.energy&&e.valence>.8*t.valence&&e.valence<1.2*t.valence})).map((function(e){return e.uri}));b(ie,T).then((function(e){S(ie,G,e).then((function(e){k(n,e,ie).then((function(e){console.log("playlist created",e),ne(!0)}))}))}))}))}))}))}))}))},De=L.map((function(e){return r.a.createElement(q,{key:e.id,id:[e.id],image:e.image,name:e.name,functionToExecute:ze,isPlaylistCreated:ee})})),Fe=f.map((function(e){return r.a.createElement(q,{key:e.id,id:[e.id],image:e.image,name:e.name,functionToExecute:Le,isPlaylistCreated:ee})})),Be=y.map((function(e){return r.a.createElement(q,{key:e.id,id:[e.artist_id,e.id],image:e.image,name:"".concat(e.name," - ").concat(e.artist),functionToExecute:Ae,isPlaylistCreated:ee})})),Ge=r.a.createElement(r.a.Fragment,null,pe?r.a.createElement(A.a,{container:!0,direction:"column",justify:"center",alignItems:"center",spacing:2,style:{minHeight:"80vh",margin:"0",width:"100%"}},r.a.createElement("h2",null,"Select an option from the list below"),r.a.createElement(A.a,{item:!0},r.a.createElement(Q.a,{variant:"contained",size:"large",onClick:function(){Re(),Ue()}},"import playlist")),r.a.createElement(A.a,{item:!0},r.a.createElement(Q.a,{variant:"contained",size:"large",onClick:function(){_e(),Ue()}},"search artist")),r.a.createElement(A.a,{item:!0},r.a.createElement(Q.a,{variant:"contained",size:"large",onClick:function(){Ne(),Ue()}},"search song"))):null),He=r.a.createElement(r.a.Fragment,null,we?r.a.createElement("div",null,r.a.createElement(Y.a,{className:Ve.back_button,onClick:function(){Re(),Ue()}},r.a.createElement($.a,{fontSize:"large"})),r.a.createElement(_,{header:ie,setUserData:T,setUserPlaylists:D}),r.a.createElement(J,{musicItems:De})):null);return r.a.createElement("div",null,de?r.a.createElement("button",{onClick:function(){return Me()}},"authenticate"):null,Ge,He,r.a.createElement(te,{isPageVisible:Ee,togglePage:_e,toggleMainMenu:Ue,searchLabel:"Artist name",newSearch:n,handleSearch:function(e){i(e.target.value)},header:ie,setValues:h,type:"artist",musicItems:Fe}),r.a.createElement(te,{isPageVisible:ke,togglePage:Ne,toggleMainMenu:Ue,searchLabel:"Song name",newSearch:s,handleSearch:function(e){u(e.target.value)},header:ie,setValues:v,type:"song",musicItems:Be}))};o.a.render(r.a.createElement(ne,null),document.getElementById("root"))},66:function(e,t,n){e.exports=n.p+"static/media/placeholder.f7c55a13.png"},76:function(e,t,n){e.exports=n(126)},81:function(e,t,n){}},[[76,1,2]]]);
//# sourceMappingURL=main.1be0b977.chunk.js.map